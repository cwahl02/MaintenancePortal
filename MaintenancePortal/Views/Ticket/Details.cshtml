@model TicketEditableViewModel


<section id="ticketContainer">
    <!-- The content will be injected here by JavaScript -->
    @await Html.PartialAsync("_TicketDetails", Model)  <!-- Initial render of ticket details -->
</section>

<script>
    function editTicket(ticketId) {
        $.ajax({
            url: '@Url.Action("Edit", "Ticket")/' + ticketId,
            type: 'GET',
            success: function(response) {
                // Inject the edit form (partial view) into the ticketContainer
                document.getElementById('ticketContainer').innerHTML = response;
            },
            error: function() {
                alert('An error occurred while loading the edit form.');
            }
        });
    }

    function saveTicket() {
        var updatedTicket = {
            Id: @Model.Id,
            Title: document.getElementById('ticketTitle').value,
            Description: document.getElementById('ticketDescriptionInput').value
        };

        $.ajax({
            url: '@Url.Action("Update", "Ticket")',
            type: 'POST',
            data: updatedTicket,
            success: function(response) {
                // Replace the ticketContainer's content with updated ticket details
                document.getElementById('ticketContainer').innerHTML = response;
            },
            error: function() {
                alert('An error occurred while saving the ticket.');
            }
        });
    }

    function cancelEdit() {
        $.ajax({
            url: '@Url.Action("Details", "Ticket")',
            type: 'GET',
            success: function(response) {
                document.getElementById('ticketContainer').innerHTML = response;
            },
            error: function() {
                alert('An error occurred while cancelling the edit.');
            }
        });
    }
</script>
